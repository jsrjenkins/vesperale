%%% This style sheet is for calendar calculating.
%%% it contains commands to select the proper antiphon and magnificat tone

%% Layout the psalms, choosing them according to the time.
\newcommand\initium[1]{
  \IfEqCase{\tempus}{
  {adventus}{\section*{Initium}\versiculus{or--deus_in_adjutorium_simplex--solesmes}}
  {pentecostes}{\section*{Initium}\versiculus{or--deus_in_adjutorium_simplex--solesmes}}
  {defunctorum}{\rubric{dicitur secreto} Pater noster \rubric{et} Ave, Maria \rubric{secus absolute incipitur a sequenti} }%% no initium for office of the dead %
}% end cases
}% End initium

\newcommand\psalterium[1]{
  \subsection*{Psalmus #1}
  \antiphoni{\tempus}{\numerus}{#1}}

\newcommand\antiphoni[4][\psalmus]{ % chooses which antiphons for the psalms
  \IfEqCase{#2}{% second argument is the \tempus #4 is which psalm
    {adventus}{\IfEqCase{#3}{ % 3rd argument is the \numerus
       {i}{\IfEqCase{#4}{ % 1st sunday antiphons
         {1}{#1{an--in_illa_die--solesmes}{109-8G}}
         {2}{#1{an--jucundare_filia--solesmes}{110-8Gstar}}
         {3}{#1{an--ecce_dominus_veniet--solesmes}{111-5a}}
         {4}{#1{an--omnes_sitientes--solesmes}{112-7c}}
         {5}{#1{an--ecce_veniet_propheta--solesmes}{113-4Astar}}
         }}% End 1st Sunday antiphons
       {ii}{\IfEqCase{#4}{ % second sunday of advent
         {1}{#1{an--ecce_in_nubibus--solesmes}{109-1g}}
         {2}{#1{an--urbs_fortitudinis--solesmes}{110-7d}}
         {3}{#1{an--ecce_apparebit--solesmes}{111-7a}}
         {4}{#1{an--montes_et_colles--solesmes}{112-1f}} 
         {5}{#1{an--ecce_dominus_noster--solesmes}{113-3a}}
         }}% End 2nd Sunday
       {iii}{\IfEqCase{#4}{ % third sunday of advent
         {1}{#1{an--veniet_dominus--solesmes}{109-1a}}
         {2}{#1{an--jerusalem_gaude--solesmes}{110-7b}}
         {3}{#1{an--dabo_in_sion--solesmes}{111-8G}}
         {4}{#1{an--montes_et_omnes_colles--solesmes}{112-5a}}
         {5}{#1{an--juste_et_pie--solesmes}{113-2D}}
         }}% End 3rd Sunday
       {iv}{\IfEqCase{#4}{ % fourth sunday of advent
         {1}{#1{an--canite_tuba--solesmes}{109-1g}}  % 1st psalm
         {2}{#1{an--ecce_veniet_desideratus--solesmes}{110-1f}} % 2nd
         {3}{#1{an--erunt_prava--solesmes}{111-1g}}  % 3rd 
         {4}{#1{an--dominus_veniet--solesmes}{112-1f}} % 4th
         {5}{#1{an--omnipotens_sermo--solesmes}{113-2D}} % 5th
         }}% End 4th Sunday
      }}% end advent cases
    {pentecostes}{\IfEqCase{#4}{
        {1}{#1{an--dixit_dominus_domino--solesmes}{109-7c2}}% 1st psalm
        {2}{#1{an--magna_opera_domini--solesmes}{110-3b}}   % 2nd psalm
        {3}{#1{an--qui_timet_dominum--solesmes}{111-4g}}    % 3rd psalm
        {4}{#1{an--sit_nomen_domini_in--solesmes}{112-7c}}  % 4th psalm
        {5}{#1{an--deus_autem_noster--solesmes}{113-per}}   % 5th psalm
      }}%% end pentecost cases
    {defunctorum}{\IfEqCase{#4}{%% not yet implemented
        {1}{#1{an--placebo_domino--solesmes}{114-req-3b}} % 1st psalm
        {2}{#1{an--heu_me_domine--solesmes}{119-req-2D}}  % 2nd psalm
        {3}{#1{an--dominus_custodit_te--solesmes}{120-req-8G}} % 3rd
        {4}{#1{an--si_iniquitates--solesmes}{129-req-8G}} % 4th psalm
        {5}{#1{an--opera_manuum_tuarum--solesmes}{137-req-2D}} % 5th
      }} % end defunctorum cases
  } % end choose instruction
} % end command

\newcommand\capitulum[2]{% argument is the Sunday and the Time
  \IfEqCase{#2}{%
    {adventus}{\IfEqCase{#1}{% simplify this mess %% TODO %%
        {i}{\section*{Capitulum} \text{capitulum-adventus-#1}}
        {ii}{\section*{Capitulum} \text{capitulum-adventus-#1}}
        {iii}{\section*{Capitulum} \text{capitulum-adventus-#1}}
        {iv}{\section*{Capitulum} \text{capitulum-adventus-#1}}
      }}%% End advent cases
    {pentecostes}{\section*{Capitulum} \text{capitulum-#2}
    }%% end Pentecost, same for all Sundays after pentecost
    {defunctorum}{\input{texti/capitulum-#2}} % verse and response for office of the dead.
  }
}
 
\newcommand\hymni[3]{
  \section*{Hymnus}% section
  \hymnus{#1}{#2}{#3}
}
\newcommand\hymnarium[2][\hymni]{% Chooses hymn according to tempus
  \IfEqCase{#2}{%
    {adventus}{
      {#1{hy--creator_alme_siderum--solesmes}{rorate}{aperiatur}}%
    }%% end advent case
    {pentecostes}{%
      {#1{hy--lucis_creator_optime--solesmes}{dirigatur}{sicut}}%
    }%% end pentecost case
    {defunctorum}{%
      {} %% office of the dead has no hymn
    }%% end defunctorum case
  }% end choices
}% end command


\newcommand\magnificat[2]{%
  \psalmus{#1}{Magnificat-#2}
}

\newcommand{\canticum}[3][\magnificat]{% There are two arguments: the season and the sunday
   \IfEqCase{#2}{%
     {adventus}{\IfEqCase{#3}{% The other Sundays are still to be filled in
       {i}     {#1{an--ne_timeas--solesmes}{8G}} % only 1st advent implemented
       {ii}    {#1{an--tu_es_qui_venturus_es--solesmes}{8G}}
       {iii}   {#1{an--beata_es_maria--solesmes}{8G}}
       {iv}    {#1{an--o_emmanuel--solesmes}{2D}} % note that this is an "O" Antiphon
                                                  % needs to be changed each year. %% TODO %%
      }}% end advent cases
    {pentecostes}{\IfEqCase{#3}{% The ones that are currently available.
        {xiii} {#1{an--unus_autem_ex_illis--solesmes_1961.gabc}{1D2}} %13th after Pentecost
        {xiv}  {#1{an--quaerite_primum--solesmes}{1g}}   %14th after Pentecost
        {xv}   {#1{an--propheta_magnus--solesmes}{4A}}   %15th after Pentecost
        {xvi}  {#1{an--cum_vocatus_fueris--solesmes}{7a}}%16th after Pentecost
        {xvii} {#1{an--quid_vobis_videtur--solesmes}{4E}}%17th after Pentecost
        {xviii}{#1{an--tulit_ergo--solesmes}{4E}}        %18th after Pentecost
        {xix}  {#1{an--intravit_autem_rex--solesmes}{3a}}%19th after Pentecost
        {xx}   {#1{an--cognovit_autem--solesmes}{3a}}    %20th after Pentecost
        {xxi}  {#1{an--serve_nequam--solesmes}{6}}       %21st after Pentecost
        {xxii} {#1{an--reddite_ergo--solesmes}{1g}}      %22th after Pentecost
        {xxiii}{#1{an--at_jesus_conversus--solesmes}{1f}}%23th after Pentecost
        {xxiv} {#1{an--amen_dico_vobis_quia_non--solesmes}{1f}}%24th after Pentecost
      }}% end pentecost cases
    {defunctorum}{\IfEqCase{#3}{% office of the dead
        {i}    {#1{an--omne_quod_dat_mihi--solesmes}{req-7c}} % note has requiem aeternam
      }} % end defunctorum
  }% end choose instruction
}%end command

\newcommand\conclusio[1]{%
  \IfEqCase{#1}{%
    {adventus}{\versiculus{or--benedicamus_adventus--solesmes} \vskip .5cm \text{fidelium}}
    {pentecostes}{\versiculus{or--benedicamus_xi--solesmes} \vskip .5cm \text{fidelium}}
    {defunctorum}{\input{texti/conclusio-#1}}
  }
}

